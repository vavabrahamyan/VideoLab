<div
  class="rounded-2xl border border-slate-800 bg-slate-900/90 p-4 shadow-xl backdrop-blur"
  (dragover)="onDragOver($event)"
  (dragenter)="onDragOver($event)"
  (dragleave)="onDragLeave($event)"
  (drop)="onDrop($event)"
>
      <input
        #filePicker
        type="file"
        accept="video/*"
        class="hidden"
        (change)="onFileSelected($event)"
      />

      <div class="relative">
        @let currentUrl = effectiveVideoUrl();
        @if (currentUrl) {
          <vg-player class="block overflow-hidden rounded-xl border border-slate-800 bg-black shadow-lg">
            <video
              #media
              [vgMedia]="$any(media)"
              [src]="currentUrl"
              id="videogular-player"
              preload="auto"
              crossorigin
              class="h-full w-full cursor-pointer bg-black"
              (click)="onVideoClick()"
              (dblclick)="onVideoDoubleClick($event)"
            ></video>

            <vg-overlay-play></vg-overlay-play>
            <vg-buffering></vg-buffering>

            @for (overlay of seekOverlayList(); track overlay.token) {
              <div class="skip-overlay skip-overlay--active">
                @if (overlay.direction === 'backward') {
                  <button
                    type="button"
                    class="skip-overlay__badge skip-overlay__badge--back skip-overlay__badge--active"
                    (click)="seekBackward()"
                  >
                    <div class="skip-overlay__text">
                      <span class="skip-overlay__label">-10</span>
                    </div>
                  </button>
                }
                @if (overlay.direction === 'forward') {
                  <button
                    type="button"
                    class="skip-overlay__badge skip-overlay__badge--forward skip-overlay__badge--active"
                    (click)="seekForward()"
                  >
                    <div class="skip-overlay__text">
                      <span class="skip-overlay__label">+10</span>
                    </div>
                  </button>
                }
              </div>
            }

            <vg-controls
              vgFor="videogular-player"
              [vgAutohide]="true"
              [vgAutohideTime]="2"
              class="flex flex-wrap items-center gap-2 bg-slate-950/80 px-3 text-slate-100"
            >
              <vg-play-pause vgFor="videogular-player"></vg-play-pause>

              <vg-time-display
                vgFor="videogular-player"
                vgProperty="current"
                vgFormat="mm:ss"
              ></vg-time-display>

              <vg-scrub-bar vgFor="videogular-player" class="flex-1">
                <vg-scrub-bar-current-time
                  class="bg-sky-500"
                ></vg-scrub-bar-current-time>
                <vg-scrub-bar-buffering-time
                  class="bg-slate-500/40"
                ></vg-scrub-bar-buffering-time>
              </vg-scrub-bar>

              <vg-time-display
                vgFor="videogular-player"
                vgProperty="left"
                vgFormat="mm:ss"
              ></vg-time-display>

              <vg-volume vgFor="videogular-player" class="min-w-24"></vg-volume>
              <vg-fullscreen vgFor="videogular-player"></vg-fullscreen>
            </vg-controls>

            <div class="player-actions player-actions--left">
              <button
                type="button"
                class="action-btn"
                aria-label="Back 10 seconds"
                title="Back 10 seconds"
                (click)="seekBackward()"
              >
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="h-5 w-5">
                  <path d="M12 5v3.18C8.5 8.66 6 11.4 6 14.75 6 18.22 8.78 21 12.25 21s6.25-2.78 6.25-6.25h-2a4.25 4.25 0 0 1-8.5 0c0-2.2 1.65-3.98 3.75-4.22V14l5-4-5-4Z"></path>
                </svg>
              </button>
              <button
                type="button"
                class="action-btn"
                [attr.aria-label]="media?.muted ? 'Unmute' : 'Mute'"
                [title]="media?.muted ? 'Unmute' : 'Mute'"
                (click)="toggleMute()"
              >
                @if (media?.muted) {
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="h-5 w-5">
                    <path d="M4 9v6h3.5L12 18.5V5.5L7.5 9H4Z"></path>
                    <path d="m16.95 7.05-1.41 1.41L17.09 10l-1.55 1.54 1.41 1.41L18.5 11.4l1.55 1.55 1.41-1.41L19.91 10l1.55-1.54-1.41-1.41L18.5 8.6l-1.55-1.55Z"></path>
                  </svg>
                } @else {
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="h-5 w-5">
                    <path d="M4 9v6h3.5L12 18.5V5.5L7.5 9H4Z"></path>
                    <path d="M16.5 8.25a4.75 4.75 0 0 1 0 7.5l-1.06-1.06a3.25 3.25 0 0 0 0-5.38l1.06-1.06Z"></path>
                    <path d="M14.25 10.5a2.5 2.5 0 0 1 0 3.96l-1.04-1.04a1 1 0 0 0 0-1.88l1.04-1.04Z"></path>
                  </svg>
                }
              </button>
            </div>

            <div class="player-actions player-actions--right">
              <button
                type="button"
                class="action-btn"
                aria-label="Forward 10 seconds"
                title="Forward 10 seconds"
                (click)="seekForward()"
              >
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="h-5 w-5">
                  <path d="M12 5v3.18c3.5.48 6 3.22 6 6.57 0 3.47-2.78 6.25-6.25 6.25S5.5 18.22 5.5 14.75h2a4.25 4.25 0 0 0 8.5 0c0-2.2-1.65-3.98-3.75-4.22V14l-5-4 5-4Z"></path>
                </svg>
              </button>
              <button
                type="button"
                class="action-btn"
                aria-label="Upload another video"
                title="Upload another video"
                (click)="filePicker.click()"
              >
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="h-5 w-5">
                  <path d="M12 5v14m7-7H5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
                </svg>
              </button>
              <button
                type="button"
              class="action-btn action-btn--danger"
              aria-label="Remove video"
              title="Remove video"
              (click)="removeVideo()"
            >
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="h-5 w-5">
                  <path d="M9.5 4.5A1.5 1.5 0 0 0 8 6v1H5.5a.75.75 0 0 0 0 1.5h13a.75.75 0 0 0 0-1.5H16V6a1.5 1.5 0 0 0-1.5-1.5h-5Zm4 1.5v1h-3V6a.5.5 0 0 1 .5-.5h2a.5.5 0 0 1 .5.5ZM7.75 10a.75.75 0 0 1 .75.75v6.5a.75.75 0 0 1-1.5 0v-6.5A.75.75 0 0 1 7.75 10Zm4.25.75a.75.75 0 1 0-1.5 0v6.5a.75.75 0 1 0 1.5 0v-6.5Zm3.25-.75a.75.75 0 0 1 .75.75v6.5a.75.75 0 0 1-1.5 0v-6.5a.75.75 0 0 1 .75-.75ZM9 21a2 2 0 0 1-2-2V9.5h10V19a2 2 0 0 1-2 2H9Z"></path>
                </svg>
              </button>
            </div>
          </vg-player>
        } @else {
          <button
            type="button"
            class="flex aspect-[16/9] min-h-[320px] w-full items-center justify-center rounded-xl border border-dashed border-slate-700 bg-slate-900/60 text-center text-slate-400 transition hover:-translate-y-0.5 hover:border-sky-500 hover:text-slate-200"
            [class.border-sky-500]="isDragOver()"
            [class.text-slate-200]="isDragOver()"
            (click)="filePicker.click()"
          >
            Drag & drop a video here, or click to upload
          </button>
        }
      </div>
    </div>
